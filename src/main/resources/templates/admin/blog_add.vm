#include("/module/admin/header.vm")
<link href="/css/editormd.min.css" rel="stylesheet"/>
<link href="/css/bootstrap-tagsinput.css" rel="stylesheet">

#include("/module/admin/top_nv.vm")
<li><a href="/admin"><i class="fa fa-area-chart"></i> Monitor</a></li>
<li class="active"><a href="/admin/blogAdd"><i class="fa fa-plus"></i> Add Blog</a></li>
<li><a href="/admin/blogList/1"><i class="fa fa-list"></i> Blog List</a></li>
<li><a href="/admin/info"><i class="fa fa-user"></i> Info</a></li>
<li><a href="/admin/resume"><i class="fa fa-male"></i> Resume</a></li>
#include("/module/admin/btm_nv.vm")
    <div id="page-wrapper">
        <div class="row">
            <div class="col-md-6 column">
                <center>
                    <form role="form" class="form-inline" name="blogForm">
                        <div class="form-group">
                            <label for="blogTitle" class="text-warning">Title</label>
                            <input type="text" class="form-control" name="title" placeholder="请输入博客标题"/>
                        </div>
                        <div class="form-group">
                            <label for="blogTags" class="text-warning">Tags</label>
                            <input type="text" class="form-control" name="tags" placeholder="输入标签后请点击回车键" data-role="tagsinput"/>
                        </div>
                        <input type="hidden" name="md" />
                        <input type="hidden" name="article" />
                        <div class="form-group">
                            <label for="blogSubmit" class="text-warning">submit</label>
                            <input type="submit" class="form-control jcala" id="save-blog" value="save"/>
                        </div>
                    </form>
                </center>
            </div>
            <div class="col-md-6 column">
                    <div class="styled-select">
                            <select id="editormd-theme-select">
                                <option disabled="disabled">select Editor.md themes</option>
                            </select>
                            <select id="editor-area-theme-select">
                                <option disabled="disabled">select editor area themes</option>
                            </select>
                            <select id="preview-area-theme-select">
                                <option disabled="disabled">select preview area themes</option>
                            </select>
                    </div>
            </div>
        </div><!-- /.row -->
    </div><!-- /#page-wrapper -->

    <div id="page-wrapper">
        <div class="row">
            <div class="col-md-12 column">
                <div id="markdown-editor">
                    <textarea style="display:none;"></textarea>
                </div>
            </div>
        </div><!-- /.row -->
    </div><!-- /#page-wrapper -->

</div><!-- /#wrapper -->

<!-- JavaScript -->
<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/editormd.min.js"></script>
<script src="/js/bootstrap-tagsinput.min.js"></script>
<script type="text/javascript">
    var testEditor;

    $(function() {
        testEditor = editormd("markdown-editor", {
            width   : "100%",
            height  : 800,
            syncScrolling : "single",
            path    : "../lib/",
            imageUpload : true,
            imageFormats : ["jpg", "jpeg", "gif", "png", "bmp", "webp"],
            imageUploadURL : "./php/upload.php?test=dfdf",
            saveHTMLToTextarea : true
        });
        function themeSelect(id, themes, lsKey, callback)
        {
            var select = $("#" + id);
            for (var i = 0, len = themes.length; i < len; i ++)
            {
                var theme    = themes[i];
                var selected = (localStorage[lsKey] == theme) ? "selected=\"selected\"" : "";

                select.append("<option value=\"" + theme + "\"" + selected + ">" + theme + "</option>");
            }
            select.bind("change", function(){
                var theme = $(this).val();

                if (theme === "")
                {
                    alert("theme == \"\"");
                    return false;
                }
                console.log("lsKey =>", lsKey, theme);
                localStorage[lsKey] = theme;
                callback(select, theme);
            });
            return select;
        }
        themeSelect("editormd-theme-select", editormd.themes, "theme", function($this, theme) {
            testEditor.setTheme(theme);
        });

        themeSelect("editor-area-theme-select", editormd.editorThemes, "editorTheme", function($this, theme) {
            testEditor.setCodeMirrorTheme(theme);
        });

        themeSelect("preview-area-theme-select", editormd.previewThemes, "previewTheme", function($this, theme) {
            testEditor.setPreviewTheme(theme);
        });
        $("#save-blog").bind('click', function(){
            var form = document.forms[0];
            form.action = "/admin/post";
            form.method = "post";
            document.blogForm.article.value=testEditor.getHTML();
            document.blogForm.md.value=testEditor.getMarkdown();
            form.submit();
        });
    });
</script>
</body>
</html>